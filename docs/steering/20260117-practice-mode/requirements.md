# Practice モード（発話練習機能） - 要件定義

**ステータス**: 要件確定
**作成日**: 2026-01-17
**最終更新日**: 2026-01-17

---

## 1. 背景と課題

### 解決したい課題

既存のSpeak/Quizモードが単調で面白くない。フレーズを登録しても、効果的に定着させる仕組みがなく、継続的な学習モチベーションが維持しにくい。

### 現状の問題点

- Speakモード: 単純な発話確認のみで、習熟度の追跡がない
- Quizモード: 選択式で、実際に発話する練習ができない
- 継続的な学習を促すゲーミフィケーション要素が不足

---

## 2. 期待する結果

### ユーザーストーリー

- ユーザーとして、母国語訳を見て学習言語で発話練習ができるようになりたい。なぜなら実際の会話で使えるようになりたいから
- ユーザーとして、日々の練習で正解回数を積み重ね、フレーズをマスターできるようになりたい。なぜなら達成感を感じながら学習したいから
- ユーザーとして、自分の発話を聞き直して確認したい。なぜなら発音を改善したいから
- ユーザーとして、マスター済みフレーズを忘れないように復習したい。なぜなら長期記憶に定着させたいから
- ユーザーとして、ランキングで他のユーザーと競い合いたい。なぜなら学習のモチベーションになるから

### ビジネスインパクト

- ユーザーの継続率向上
- 学習効果の向上によるユーザー満足度アップ
- ランキング機能によるソーシャル要素の強化

---

## 3. ゴール

### 実現すること（ゴール）

- [ ] 母国語訳を見て発話し、80%以上一致で正解判定
- [ ] フレーズごとの正解回数（0〜5）と不正解回数を記録、5回正解でマスター
- [ ] 1日1回までしか正解回数が増えない制限
- [ ] 今日正解したフレーズはその日は出題しない
- [ ] 正解/不正解時に一致率・認識テキスト・正解テキスト比較 + TTS再生
- [ ] 自分の発話音声を再生できる（非DB保存）
- [ ] **通常モード**: 未マスター（正解回数0〜4）かつその日未正解のフレーズを、登録日時が古い順に出題
- [ ] **復習モード**: マスター済み（正解回数5）かつその日未正解のフレーズを、登録日時が古い順に出題
- [ ] ユーザー設定でSpeak/Quiz ↔ Practice の切り替え（デフォルト: Practice）
- [ ] ユーザー設定で「既存フレーズをPractice対象に含めるか」を選択可能（デフォルト: 含めない）
- [ ] フレーズ一覧の表示をユーザー設定に応じて切り替え（Speak/Quiz: 音読回数・クイズ回数 / Practice: 正解回数）
- [ ] 既存ランキング画面に「マスター数」「合計正解回数」ランキングを追加

### 今回は対象外（非ゴール）

- 音声データのDB保存（自分の発話もTTSも保存しない）
- 既存のSpeak/Quizモードの削除（旧機能として残す）
- 複雑なスペースド・リピティションアルゴリズム（シンプルな5回マスター制）

---

## 4. 成功指標

| 指標 | 目標値 | 測定方法 |
|------|--------|----------|
| Practiceモード利用率 | 新規ユーザーの80%以上 | デフォルト設定のままPracticeを使用 |
| マスターフレーズ数 | ユーザーあたり週5フレーズ以上 | DB集計 |
| 継続利用率 | 週3日以上のアクティブ率向上 | ログイン・練習ログ分析 |

---

## 5. 制約条件

### 技術的制約

- 音声認識はWeb Speech API（既存のSpeak機能と同様）
- 音声データはDB保存しない（ブラウザのメモリ内で処理）
- TTSはGoogle Cloud TTS（既存実装を流用）

### ビジネス制約

- 既存のSpeak/Quizモードは削除せず、旧機能として残す
- ユーザー設定で切り替え可能にする

### 前提条件

- ユーザーはログイン済み
- ユーザーは1つ以上のフレーズを登録済み
- ブラウザがWeb Speech APIをサポート（マイク許可済み）

---

## 参考情報

- 既存のSpeakモード: `src/app/[locale]/phrase/components/speak/`
- 既存のQuizモード: `src/app/[locale]/phrase/components/quiz/`
- 既存のランキング機能: `src/app/[locale]/ranking/`
- ユーザー設定: `src/app/[locale]/settings/`
